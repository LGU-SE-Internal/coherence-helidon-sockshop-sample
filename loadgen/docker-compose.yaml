version: '3.8'

services:
  loadgen:
    build: .
    image: loadgen:latest
    ports:
      - "8089:8089"
    environment:
      - LOCUST_MIN_WAIT=1
      - LOCUST_MAX_WAIT=3
    command: >
      -f locustfile.py
      --host=${TARGET_HOST:-http://localhost:8079}
    volumes:
      - ./config.yaml:/loadgen/config.yaml:ro
    networks:
      - sockshop

networks:
  sockshop:
    external: false
